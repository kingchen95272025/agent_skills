# 第五阶段：文档优化

## 阶段目标

基于评审报告优化PRD，提升质量到8.5分以上，确保文档达到发布标准。

## 前置条件

- 已完成需求评审阶段
- 存在 `.claude/prd/{功能名}/review.md` 文件
- 评审报告显示得分在6.0-8.4分之间，或用户明确要求优化

## 优化原则

### 1. 优先级驱动

- **P0问题优先**：必须修复的严重问题
- **P1问题其次**：重要但不阻塞的问题
- **P2问题最后**：锦上添花的改进

### 2. 影响范围评估

- **高影响**：影响核心功能或多个模块
- **中影响**：影响单个功能或模块
- **低影响**：影响局部细节

### 3. 工作量控制

- **每轮优化目标**：解决主要问题，提升1-1.5分
- **最多优化轮次**：3轮，避免无限循环
- **时间控制**：每轮优化控制在合理时间内

## 工作内容

### 1. 制定优化计划

基于评审报告，按优先级制定优化计划：

**第一轮优化重点**（目标：解决P0问题）：
- 列出所有P0级别问题
- 评估修复工作量
- 制定修复方案
- 确定优化顺序

**第二轮优化重点**（目标：解决P1问题）：
- 列出所有P1级别问题
- 评估修复工作量
- 制定修复方案
- 选择性修复

**第三轮优化重点**（目标：提升文档质量）：
- 处理部分P2问题
- 完善细节描述
- 优化文档格式
- 提升整体质量

### 2. 执行优化改进

针对评审报告中的问题，逐项进行优化：

#### 需求完整性优化

- **补充缺失功能**：添加遗漏的功能场景
- **完善边界条件**：明确功能边界和约束
- **增强异常处理**：补充异常场景的处理规则

#### 可执行性优化

- **清晰化需求描述**：消除歧义，增强准确性
- **完善界面设计**：补充界面设计细节
- **明确业务规则**：详细定义业务规则和验证逻辑

#### 用户价值优化

- **突出用户价值**：明确每个功能的价值和ROI
- **优化用户体验**：简化流程，提升易用性
- **强化价值创造**：量化业务收益

#### 业务逻辑优化

- **优化业务流程**：简化流程，提升效率
- **完善业务规则**：补充规则定义，消除冲突
- **增强数据一致性**：优化数据模型，保证一致性

#### 文档质量优化

- **优化文档结构**：调整章节组织，提升可读性
- **提升描述准确性**：修正术语使用，消除错误
- **规范文档格式**：统一格式，完善图表

### 3. 更新PRD文档

将优化内容更新到PRD文档：

- 修改 `.claude/prd/{功能名}/draft.md` 文件
- 或创建 `.claude/prd/{功能名}/prd.md` 新版本
- 记录优化变更内容
- 保持与前序文档的一致性

### 4. 重新评审

每轮优化完成后，重新评审PRD质量：

- 按照评审标准重新评分
- 对比优化前后的得分变化
- 识别剩余问题
- 决定是否需要继续优化

### 5. 创建或更新优化记录

创建或更新 `.claude/prd/{功能名}/optimization_log.md`，记录优化历程：

```markdown
# {功能名}优化记录

## 优化历史

### 第一轮优化（YYYY-MM-DD）

**优化前得分**：7.2分

**主要问题**：
1. 供应商评级算法未明确
2. 询价超时处理规则不清晰
3. 价格对比维度不够全面

**优化内容**：
1. 补充供应商评级算法的计算规则
   - 定义了质量、交期、价格、服务四个维度
   - 明确了各维度的权重分配
   - 说明了评级的计算公式

2. 完善询价超时处理规则
   - 定义超时时间为48小时
   - 超时后自动关闭询价单
   - 发送提醒通知给相关人员

3. 扩展价格对比维度
   - 增加质量评级对比
   - 增加交期对比
   - 增加历史合作记录对比

**优化后得分**：8.1分

**得分提升**：+0.9分

**剩余问题**：
1. 统计报表需求描述过于简单
2. 部分业务规则定义不够详细

---

### 第二轮优化（YYYY-MM-DD）

[记录第二轮优化内容]

---

## 优化总结

- **初始得分**：7.2分
- **当前得分**：8.5分
- **总提升**：+1.3分
- **优化轮次**：2轮
- **达标情况**：已达到发布标准（≥8.5分）
```

## 优化控制

### 最多优化轮次

- **第一轮**：解决P0问题，目标得分7.5-8.0
- **第二轮**：解决P1问题，目标得分8.0-8.5
- **第三轮**：完善细节，目标得分≥8.5

超过3轮仍未达标，需要：
- 重新审视需求调研和产品规划
- 考虑是否需要调整产品方案
- 与用户讨论是否降低标准或分阶段实施

### 停止优化条件

满足以下任一条件即可停止优化：

1. **得分达标**：综合得分≥8.5分
2. **用户满意**：用户明确表示满意并认可当前版本
3. **轮次上限**：已完成3轮优化
4. **边际效益递减**：优化效果不明显，提升<0.3分

## 质量检查清单

每轮优化完成后，检查：

- [ ] P0问题是否全部修复
- [ ] P1问题是否大部分修复
- [ ] 优化内容是否准确完整
- [ ] 是否保持了文档一致性
- [ ] 得分是否有明显提升
- [ ] 是否达到了优化目标
- [ ] 是否需要继续优化

## 完成确认

每轮优化完成后，我会：

1. 向您展示优化内容和效果
2. 说明得分变化和提升幅度
3. 列出剩余问题和改进空间
4. 征求您的意见和建议
5. 确认是否需要继续优化
6. 等待您的明确决定

## 注意事项

- 优化要基于评审报告的具体问题
- 要保持与前序文档的一致性
- 不要过度优化导致范围蔓延
- 控制优化轮次避免无限循环
- 每轮优化都要重新评审验证效果

## 优化示例

### 优化前（问题）

**供应商评级功能描述**：

```markdown
系统支持供应商评级功能，采购人员可以对供应商进行评级。
```

**问题**：
- 评级规则未明确
- 评级维度不清楚
- 评级结果如何使用未说明

### 优化后（改进）

**供应商评级功能描述**：

```markdown
### 供应商评级功能

**功能概述**：
系统支持多维度的供应商评级功能，帮助企业量化评估供应商绩效，为采购决策提供数据支持。

**评级维度**：

| 维度 | 权重 | 评分标准 | 数据来源 |
|------|------|----------|----------|
| 质量 | 35% | 合格率、退货率、质量问题次数 | 质检系统 |
| 交期 | 30% | 准时交货率、延迟天数 | 订单系统 |
| 价格 | 25% | 价格竞争力、成本控制 | 采购系统 |
| 服务 | 10% | 响应速度、配合度、问题处理 | 人工评分 |

**评级计算**：

综合得分 = 质量得分 × 35% + 交期得分 × 30% + 价格得分 × 25% + 服务得分 × 10%

**评级等级**：

- A级（优秀）：综合得分 ≥ 90分
- B级（良好）：综合得分 80-89分
- C级（合格）：综合得分 70-79分
- D级（观察）：综合得分 < 70分

**评级应用**：

- A级供应商：优先合作，增加订单份额
- B级供应商：正常合作，稳定订单份额
- C级供应商：限制合作，要求改进计划
- D级供应商：停止新订单，启动替换程序

**评级周期**：

- 评级周期：每季度评估一次
- 数据统计期：最近6个月的业务数据
- 评级有效期：3个月，到期自动重新评估
```

**改进点**：
- 明确了评级的4个维度和权重
- 详细说明了评级计算规则
- 定义了评级等级和标准
- 说明了评级结果的应用方式
- 补充了评级周期和数据来源

## 推进到下一阶段

### 达到标准（≥8.5分）

"第X轮优化完成，得分提升到8.5分，PRD质量已达到发布标准！准备好制作最终交付版本了吗？"

### 需要继续优化（<8.5分）

"第X轮优化完成，得分提升到X.X分，还有一些改进空间。要不要继续优化还是现在这个版本就可以了？"

### 达到优化上限

"已完成3轮优化，当前得分X.X分。虽然还未达到8.5分，但主要问题已经解决。建议现在进入发布准备，后续可以在实施过程中持续完善，您看如何？"
