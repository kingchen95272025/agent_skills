# 阶段四：代码生成阶段详细指南

## 阶段目标

生成完整的、可运行的静态交互HTML代码。

## 输入条件

- 界面规划文档（`ui_plan.md`）已完成
- 模板选择记录（`template_choice.md`）已完成
- 模板文件已加载

## 页面生成原则

1. 如果需要生成一组多个页面
    - 必须有一个index.html文件，作为主页面串联所有页面。
    - 每个页面必须有独立的HTML文件。
    - 所有页面必须使用相同的UI模板风格。
    - 注意多个页面之间的跳转。
    - 多个页面必须逻辑闭环，支持点击页面内的按钮或链接跳转到其他页面。

## 代码生成原则

###核心原则

1. 严格参考已选模板的样式和组件结构，除非用户有特殊要求，不要进行修改。
2. 必须完整读取模板文件，并严格按照模板文件的结构和样式生成代码。如果模板文件太长，需要分多次读取。
3. 图标优先使用FontAwesome开源图标库，非必要不使用图标，避免滥用。
4. 严格遵循界面规划，按照ui_plan.md中的设计实现。
5. 使用模板样式系统，基于选定模板的样式和组件。
6. 代码结构清晰，HTML/CSS/JS分离清晰，层次分明。
7. 详细代码注释，关键逻辑必须有注释说明。
8. 语义化HTML，使用语义化标签，提升可读性。
9. 响应式设计，支持不同屏幕尺寸。
10. 直接可运行，无需构建工具，浏览器直接打开即可运行。

## 生成步骤

### 步骤1：准备生成环境

创建输出目录：
```bash
.claude/ui-generator/{功能名}/generated/
```

加载模板资源：
- CSS样式系统
- JavaScript交互框架
- 组件代码片段

### 步骤2：逐页面生成HTML

按照界面规划中的页面清单，逐个生成HTML文件。

#### HTML文件结构

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[页面标题]</title>
    <style>
        /* [模板的CSS样式] */
    </style>
</head>
<body>
    <!-- [页面内容] -->
    
    <script>
        // [JavaScript交互逻辑]
    </script>
</body>
</html>
```

### 步骤3：实现完整功能

必须实现的功能清单（根据界面规划）：

**基础功能**：
- ✅ 页面布局和样式
- ✅ 数据渲染（基于mockData）
- ✅ 响应式设计

**数据展示**：
- ✅ 表格/列表渲染
- ✅ 统计卡片（如需要）
- ✅ 数据详情展示

**筛选搜索**：
- ✅ 搜索功能
- ✅ 筛选条件
- ✅ 清除筛选
- ✅ 分页

**CRUD操作**：
- ✅ 新增（模态框 + 表单 + 保存）
- ✅ 编辑（模态框 + 表单填充 + 更新）
- ✅ 查看详情（模态框 + 数据展示）
- ✅ 删除（确认对话框 + 删除）
- ✅ 批量操作（如需要）

**表单验证**：
- ✅ 必填项验证
- ✅ 格式验证
- ✅ 错误提示显示

**状态管理**：
- ✅ 状态标签显示
- ✅ 状态切换（如需要）

**交互反馈**：
- ✅ 成功/失败消息提示
- ✅ 加载动画
- ✅ 确认对话框

**其他功能**：
- ✅ 导入导出（如需要）
- ✅ 其他特殊功能

### 步骤4：代码注释规范

**HTML注释**：
```html
<!-- 统计卡片区 -->
<div class="stats-cards">
    <!-- 卡片内容 -->
</div>

<!-- 筛选搜索区 -->
<div class="table-filter">
    <!-- 筛选表单 -->
</div>
```

**JavaScript注释**：
```javascript
// ========== 数据定义 ==========
const mockData = [...];

// ========== 基础功能函数 ==========
// 搜索列表
function searchList() {
    // 实现逻辑
}

// ========== CRUD操作函数 ==========
// 新增数据
function addItem() {
    // 实现逻辑
}
```

### 步骤5：生成README文档

在generated目录下创建README.md，说明使用方法。

## 输出成果

- `generated/` 目录下的所有HTML文件
- `generated/README.md` - 使用说明文档

## 完成标准

- ✅ 所有计划的页面都已生成
- ✅ 代码可以直接在浏览器中打开运行
- ✅ 所有规划的功能都已实现
- ✅ 代码结构清晰，注释完善
- ✅ 符合选定模板的风格

## 评估维度

- **代码完整性（30%）**：是否实现了所有规划的功能
- **代码规范性（25%）**：是否符合HTML/CSS/JS规范
- **代码可读性（20%）**：结构是否清晰，注释是否完善
- **视觉还原度（15%）**：是否符合模板风格
- **功能可用性（10%）**：交互是否正常工作

## 推进到下一阶段

```
"代码生成完成！我为您生成了 [N] 个HTML文件：
- [文件1]：[说明]
- [文件2]：[说明]

所有文件都可以直接在浏览器中打开运行，包含了完整的[功能列表]。

现在我来全面验证一下交互功能的完整性和可用性，好吗？"
```
