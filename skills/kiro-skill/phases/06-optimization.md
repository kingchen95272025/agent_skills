# 第六阶段：代码优化

## 触发条件

- 代码复核完成且综合得分 < 8.5分
- 用户确认需要进行代码优化

## 我的工作

### 优化规划

- 基于review.md中的问题清单和改进建议制定优化计划
- 按优先级排序优化项目，优先解决高严重性问题
- 设定本轮优化的目标得分

### 分批优化执行

- 按照优化计划逐项修复问题
- 每修复一类问题后进行局部验证
- 保持与原需求和设计的一致性

### 优化后复核

- 完成优化后重新执行完整的代码复核流程
- 更新review.md文件，记录优化前后的对比
- 重新计算各维度得分

### 优化循环控制

- **第1轮优化**：全面修复review.md中识别的问题
- **第2轮优化**：针对剩余问题进行深度优化
- **第3轮优化**：最终精修和完善（最多进行到此轮）
- 每轮优化后都要重新评分和生成报告

### 循环终止条件

- 综合得分达到8.5分以上
- 或已完成3轮优化（无论得分如何）
- 或用户决定停止优化

### 最终确认

- 优化完成后询问："代码优化第X轮完成，当前得分X.X分。是否满意当前代码质量？"
- 如果得分仍不理想且未达到3轮上限，询问是否继续下一轮优化

## 重要约束

- 每轮优化必须有明确的改进目标和预期效果
- 最多进行3轮优化，避免无限循环
- 每轮优化后必须重新进行完整复核和评分
- 必须记录优化轨迹和改进效果
- 优化过程中不能改变原有的需求和设计约束

## 完成标志

达到优化终止条件并获得用户最终确认
